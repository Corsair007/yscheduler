<link href="${rc.contextPath}/assets/css/autocomplete.css"
	rel="stylesheet" />
<link href="${rc.contextPath}/assets/css/chosen.min.css"
	rel="stylesheet" />
<link href="${rc.contextPath}/static/css/custom.css" rel="stylesheet" />

<script type="text/javascript"
	src="${rc.contextPath}/assets/js/jquery.dataTables.min.js"></script>
<script type="text/javascript"
	src="${rc.contextPath}/assets/js/jquery.dataTables.bootstrap.js"></script>
<script src="${rc.contextPath}/assets/js/jquery.autocomplete.js"
	type="text/javascript"></script>
<script src="${rc.contextPath}/assets/js/chosen.jquery.min.js"
	type="text/javascript"></script>
<script src="${rc.contextPath}/assets/js/bootbox.min.js"
	type="text/javascript"></script>
<script src="${rc.contextPath}/assets/js/jquery.validate.min.js"
	type="text/javascript"></script>
<script src="${rc.contextPath}/static/js/validate.js"
	type="text/javascript"></script>

<script type="text/javascript">
	function addTask() {
		$("#taskTable").append($("#taskRow").html());
		$(".chosen-select").chosen({});
	};
	function removeTask(btn) {
		$(btn).parent().parent().remove();
	};
	function createTask(form) {
		//遍历form，修改name，后缀添加i
		try {
			$.each($("#taskTable tr"), function(i, el) {
				var tds = $(el).children("td");
				$.each(tds, function(j, td) {
					var input = $(td).children("input");
					if (!(input.length > 0)) {
						input = $(td).children("select");
					}
					var name = input.attr("name");
					if (name) {
						if (name.charAt(name.length - 2) == '_') {
							name = name.substring(0, name.length - 2);
						}
						input.attr("name", name + '_' + i);
					}
				});
			});
		} catch (e) {
			console.log(e);
		}
		$.ajax({
			type : $(form).attr('method'),
			url : $(form).attr('action'),
			data : $(form).serialize(),
			dataType : "json",
			success : createTaskDone,
			error : app.httpError
		});
		return false;
	};
	function createTaskDone(data) {
		if (data.success == false) {
			app.alertError(data.errorMsg);
		} else {
			window.location = window.contextPath + "/workflow";
		}
	};
	$("[rel=tooltip]").tooltip();
	$(document).ready(function() {
		app.onCrontabTip();
		$(".chosen-select").chosen({});
	});
</script>

